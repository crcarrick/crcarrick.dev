---
title: How I coded my way to victory in World of Warcraft
description: A brief detour into my third love, World of Warcraft, and how my coding skills helped me excel at the game. 
featuredImage: ../../src/assets/images/weakauras.png
featuredIcon: wow
author: Chris Carrick
published: 2022-01-10T11:48:12.000Z
tags: ['lua', 'world of warcraft', 'weakauras']
---

<!-- Gotta find the TONE here -->

<!-- Opening segment -->
I have a confession to make... I play *a lot* of [World of Warcraft](https://worldofwarcraft.com/en-us/). Twice a week, a few hours after dinner, me and 19 other guys and gals team up for 4 hours to beat our heads against the latest bosses the game has to offer. I primarily play a [Monk](https://worldofwarcraft.com/en-us/game/classes/monk), and my team generally ranks somewhere inside the top 100 teams in the US, even finishing as high as US #42 two dungeons ago. I'm proud of that, as finishing in the US Top 100 is quite good for an 8 hour / week team. Many teams play together for 12 or even 16 hours   / week. The very very best groups quite literally play 16 hours **per day**, 7 days a week; not stopping until the final boss of the dungeon is defeated. If you're interested (let's be honest, you're not), the whole ordeal is live-streamed on [Twitch](https://twitch.tv) in a pretty popular event known as the [Race to World First](https://raider.io/sanctum-of-domination/global-coverage) each time a new dungeon is released. For these top teams, it can take upwards of ~10-14 days of this insane schedule to finish the dungeon. For us mortals, it takes months. 

I know what you're thinking, and you're right. I am pretty cool ðŸ˜Ž.

I'd love to talk your ear off about "Theorycrafting" (the art of figuring out, via some pretty complicated math, the best way to play a particular class), my awesome teammates, or how rewarding it is to finally have all 20 people on the team "click" for that one perfect attempt and defeat the final boss of a dungeon after literally hundreds of attempts. The teamwork and coordination required to take 20 nerds sitting behind desks around the country and mold them into a coherent unit capable of executing some pretty sophisticated strategies is something magical and unique about WoW. I've never found anything like it in any other game, believe me, I've tried. That teamwork, comradery, and sense of accomplishment is the primary reason I keep logging on every week. Unfortunately, this post isn't about any of that.

### Some Header

<!-- Intro to WeakAuras -->
I love to code. I find my work incredibly enjoyable and rewarding, and after the workday ends I often hack on a hobby project for a few hours in the evening trying to learn something new. So you can imagine when I, as a new player ([noob](https://www.dictionary.com/browse/noob)) to WoW, discovered that I could write code that would assist my teammates and I in our quest to defeat the toughest bosses the game has to offer, I was pretty dang excited.  Let me tell you about a little program called [WeakAuras](https://github.com/WeakAuras/WeakAuras2).

WeakAuras bills itself as:

<Callout variant="info">"A powerful and flexible framework that allows the display of highly customizable graphics on World of Warcraft's user interface."</Callout> 

Essentially, the program helps you, the player, write code that responds to a variety of events that the game's UI publishes. WoW's bosses are highly scripted encounters, and these "customizable graphics" can be things like:

- Little icons that count down to when a particular event is going to happen 
- Fully-fledged programs that dynamically make and display decisions about which players to assign to handle certain jobs during the encounter. 

The program is so powerful, that the "very very best groups" I mentioned earlier have gone as far as to hire (for real money!) dedicated programmers whose sole job is to quickly, on-the-fly write them custom WeakAuras during the aforementioned **Race to World First**. WoW's development team has publically stated that when designing bosses, they now design around the knowledge that players will create clever WeakAuras to help them defeat the boss.

<!-- Do I embed the video here?  Or as a link within the text -->
This all might sound like cheating, but WoW's UI has always allowed "add-ons" to modify it.  At times, when players have [created WeakAuras that were deemed too powerful](), the WoW development team has reigned the add-on back in by restricting code access to the problematic APIs. 

<video width="560" height="315" src="https://www.youtube.com/embed/ZJoJWQapVQo?controls=0" />

### Examples

<!-- Section about Lua and writing WeakAuras -->
You're probably here for the code, so let's get into that. WoW's UI API is written in [Lua](https://www.lua.org/). If you aren't familiar, Lua is a great little scripting language designed to be embedded into larger pieces of C / C++ software. You can even, thanks to web assembly, [run it in the browser](https://fengari.io/). It has quirks that take some getting used to (Lua's Arrays start at index 1 ðŸ‘€), but by and large it's great at what it does and is particularly ubiquitous in computer game UIs. As I mentioned earlier, much like JavaScript, WoW's UI is event driven. Your code registers listeners for certain events and then reacts to them as they occur. The APIs exposed by the WoW UI, however, can be a bit clunky. This is where WeakAuras comes in.  At it's core, it is a complex wrapper around the WoW UI API; abstracting away many of the pain points of interacting with the base APIs.

Let's finally jump into some examples. WeakAuras are broken down into several functions:

- `onInit`  - Initializes any state you want when the WeakAura first loads.  
- `trigger` - Receives some event based arguments and tells the WeakAura whether or not it should display on the screen by returning a boolean value. 
- `display` - Returns a value that will actually be displayed on the screen. 

The following is a simple example WeakAura that counts the number of times a specific event has happened in an encounter and displays it on the player's screen.

<Callout variant="warning">
  <b>This is by no means supposed to serve as a WeakAuras tutorial</b>.  I've intentionally changed things and left things out to make this all easier to understand.  
</Callout>

```lua { "filename": "onInit" }
function()
  -- aura_env is a non-reactive table scoped to your WeakAura 
  -- that you can write data you want to be preserved 
  -- between renders to. think `React.useRef()`
  aura_env.count = 0
end
```

```lua { "filename": "trigger" }
function(event, subevent)
  if event == "COMBAT_EVENT" 
    and subevent == "SPELLCAST_SUCCEEDED" 
  then
    aura_env.count = aura_env.count + 1
  end

  return aura_env.count > 0
end
```

```lua { "filename": "display" }
function()
  return string.format(
    "Event has happened %s time(s).",
    aura_env.count
  )
end
```

If you come from React, this pattern should be immediately recognizable to you. These functions are pretty similar to parts of the old React component lifecycle. I think it's  clear to see how this can be powerful, but this example isn't particularly useful. Perhaps, on a specific boss, you want to rotate and remind 3 of your players to take some action (cast a powerful healing spell or something) to save the group each time the boss attacks the group with a powerful ability. WeakAuras makes that easy. Below, I've adapted the last example to do that.

```lua { "filename": "onInit" }
function()
  aura_env.count = 0
  aura_env.currentPlayer = nil
  aura_env.playerRotation = { 
    "Player 1", 
    "Player 2", 
    "Player 3" 
  }
end
```

```lua { "filename": "trigger" }
-- spellId is just a made up argument here that would 
-- identify a particular ability we wanted to watch 
-- out for
function(event, subevent, spellId)
  if event == "COMBAT_EVENT" 
    and subevent == "SPELLCAST_SUCCEEDED" 
    and spellId === 123456 
  then
    aura_env.count = aura_env.count + 1
    aura_env.currentPlayer = 
      aura_env.playerRotation[aura_env.count % 3] 
  end

  return aura_env.currentPlayer != nil
end
```

```lua { "filename": "display" }
function()
  return string.format(
    "Save the group %s!",
    aura_env.currentPlayer
  )
end
```

You could even adapt that last `trigger` function to only show the text on the screen of the person whose turn it currently is using some [built-ins](https://github.com/WeakAuras/WeakAuras2/wiki/Useful-variables-and-functions-within-WeakAuras) WeakAuras provides you.

```lua { "filename": "trigger", "highlight": "5" }
function(event, subevent, spellId)
  -- ...rest of trigger fn

  return aura_env.currentPlayer != nil 
    and aura_env.currentPlayer == WeakAuras.me
end
```

<!-- TODO: Some end to the code section here?  Conclusion?  Need to wrap this up and bring it around to the point somehow -->

### Some good Outro Heading

<!-- Outro (which is bad so far and you should feel bad) -->
It sounds dumb, but I've picked up quite a few valuable, transferable skills playing this game.  And, no, not just a new programming language I probably wouldn't have been exposed to otherwise. While that's certainly cool, I think that when the sun sets on WoW and the game is no longer around, what I'll *really* have taken with me are some of the lessons I learned about

- being a member and eventually leader of a large and diverse team
- collective problem-solving to achieve a common goal 

<!-- SAY CHEESE!!!! -->
and of course the friends I made along the way.

Before I go, just for fun, here's the final 1.5 minutes of top team Limit achieveing a world first final boss kill last year.  If you have a sharp eye, you'll notice a *lot* of WeakAuras on the screens of the featured players.

***WARNING*** explicit language and lots of "nerdscreams"

[Limit achieving World First](https://youtu.be/Kgzm2XP1hMo?t=690)